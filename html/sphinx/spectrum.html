<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>spectrum &mdash; pyspeckit 0.1.13 documentation</title>
    
    <link rel="stylesheet" href="_static/extra.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.13',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/logo.ico"/>
    <link rel="top" title="pyspeckit 0.1.13 documentation" href="index.html" />
     
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setDomainName', 'pyspeckit.bitbucket.org']);
      _gaq.push(['_setAllowHash', false]);
      _gaq.push(['_trackPageview']);


    </script>
    <link rel="stylesheet" type="text/css" href="_static/extra.css" />
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
          <p class="logo"><a href="http://pyspeckit.bitbucket.org">
            <img class="logo" src="_static/logo.png" alt="Logo"/>
          </a></p>
        <h1><a href="index.html">pyspeckit 0.1.13 documentation</a></h1>
        <div class="rel">
          <a href="http://pyspeckit.bitbucket.org/">PySpecKit Home </a>  |
          <a href=index.html>Docs Home </a>  |
          <a href="https://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/overview">Bitbucket Home </a>  |
          <a href="https://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/wiki/Home">Wiki</a>  |
          <a href=search.html>Search </a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-pyspeckit.spectrum.classes">
<span id="spectrum"></span><h1>spectrum<a class="headerlink" href="#module-pyspeckit.spectrum.classes" title="Permalink to this headline">¶</a></h1>
<p>The spectrum module consists of the Spectrum class, with child classes ObsBlock
and Spectra for multi-spectrum analysis of different types.</p>
<p>The Spectrum class is the main functional code.
ObsBlocks are containers of multiple spectra of different objects
The Spectra class is a container of multiple spectra of the <em>same</em> object at</p>
<blockquote>
<div>different wavelengths/frequencies</div></blockquote>
<dl class="class">
<dt id="pyspeckit.spectrum.classes.Spectrum">
<em class="property">class </em><tt class="descclassname">pyspeckit.spectrum.classes.</tt><tt class="descname">Spectrum</tt><big>(</big><em>filename=None</em>, <em>filetype=None</em>, <em>xarr=None</em>, <em>data=None</em>, <em>error=None</em>, <em>header=None</em>, <em>doplot=False</em>, <em>maskdata=True</em>, <em>plotkwargs={}</em>, <em>xarrkwargs={}</em>, <em>**kwargs</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L41" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-41" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>The core class for the spectroscopic toolkit.  Contains the data and error
arrays along with wavelength / frequency / velocity information in various
formats.</p>
<p class="rubric">Methods</p>
<p>Create a Spectrum object.</p>
<p>Must either pass in a filename or ALL of xarr, data, and header, plus
optionally error.</p>
<p>kwargs are passed to the file reader</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>filename</strong> : string or pyfits.HDU</p>
<blockquote>
<div><p>The file to read the spectrum from.  If data, xarr, and error are
specified, leave filename blank.</p>
</div></blockquote>
<p><strong>filetype</strong> : string</p>
<blockquote>
<div><p>Specify the file type (only needed if it cannot be automatically
determined from the filename)</p>
</div></blockquote>
<p><strong>xarr</strong> : <tt class="xref py py-obj docutils literal"><span class="pre">units.SpectroscopicAxis</span></tt> or <tt class="xref py py-obj docutils literal"><span class="pre">np.ndarray</span></tt></p>
<blockquote>
<div><p>The X-axis of the data.  If it is an np.ndarray, you must pass
<tt class="xref py py-obj docutils literal"><span class="pre">xarrkwargs</span></tt> or a valid header if you want to use any of the unit
functionality.</p>
</div></blockquote>
<p><strong>data</strong> : <tt class="xref py py-obj docutils literal"><span class="pre">np.ndarray</span></tt></p>
<blockquote>
<div><p>The data array (must have same length as xarr)</p>
</div></blockquote>
<p><strong>error</strong> : <tt class="xref py py-obj docutils literal"><span class="pre">np.ndarray</span></tt></p>
<blockquote>
<div><p>The error array (must have same length as the data and xarr arrays)</p>
</div></blockquote>
<p><strong>header</strong> : <tt class="xref py py-obj docutils literal"><span class="pre">pyfits.Header</span></tt> or dict</p>
<blockquote>
<div><p>The header from which to read unit information.  Needs to be a
<tt class="xref py py-obj docutils literal"><span class="pre">pyfits.Header</span></tt> instance or another dictionary-like object with the
appropriate information</p>
</div></blockquote>
<p><strong>maskdata</strong> : boolean</p>
<blockquote>
<div><p>turn the array into a masked array with all nan and inf values masked</p>
</div></blockquote>
<p><strong>doplot</strong> : boolean</p>
<blockquote>
<div><p>Plot the spectrum after loading it?</p>
</div></blockquote>
<p><strong>plotkwargs</strong> : dict</p>
<blockquote>
<div><p>keyword arguments to pass to the plotter</p>
</div></blockquote>
<p><strong>xarrkwargs</strong> : dict</p>
<blockquote class="last">
<div><p>keyword arguments to pass to the SpectroscopicAxis initialization
(can be used in place of a header)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">pyspeckit</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
<span class="go">            xarr=np.linspace(-50, 50, 100), error=np.ones(100)*0.1, </span>
<span class="go">            xarrkwargs={&#39;unit&#39;:&#39;km/s&#39;, &#39;refX&#39;:4.829, &#39;refX_units&#39;:&#39;GHz&#39;,</span>
<span class="go">                &#39;xtype&#39;:&#39;VLSR-RAD&#39;}, header={})</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">xarr</span> <span class="o">=</span> <span class="n">pyspeckit</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">SpectroscopicAxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span>
<span class="go">            units=&#39;km/s&#39;, refX=6562.83, refX_units=&#39;angstroms&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">data</span><span class="o">/</span><span class="mf">5.</span><span class="p">)</span><span class="o">*</span><span class="mf">5.</span> <span class="c"># Poisson noise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">pyspeckit</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">err</span><span class="p">,</span> <span class="n">xarr</span><span class="o">=</span><span class="n">xarr</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="p">{})</span> 
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># if you already have a simple fits file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">pyspeckit</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="s">&#39;test.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="pyspeckit.spectrum.classes.Spectrum.copy">
<tt class="descname">copy</tt><big>(</big><em>deep=True</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L521" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-521" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectrum.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a copy of the spectrum with its own plotter, fitter, etc.
Useful for, e.g., comparing smoothed to unsmoothed data</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.classes.Spectrum.crop">
<tt class="descname">crop</tt><big>(</big><em>x1</em>, <em>x2</em>, <em>units=None</em>, <em>**kwargs</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L320" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-320" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectrum.crop" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace the current spectrum with a subset from x1 to x2 in current
units</p>
<p>Fixes CRPIX1 and baseline and model spectra to match cropped data spectrum</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.classes.Spectrum.downsample">
<tt class="descname">downsample</tt><big>(</big><em>dsfactor</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L446" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-446" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectrum.downsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Downsample the spectrum (and all of its subsidiaries) without smoothing</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>dsfactor</strong> : int</p>
<blockquote class="last">
<div><p>Downsampling Factor</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyspeckit.spectrum.classes.Spectrum.flux">
<tt class="descname">flux</tt><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectrum.flux" title="Permalink to this definition">¶</a></dt>
<dd><p>The data in the spectrum (flux = data, for compatibility with astropy&#8217;s
Spectrum1D object).</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.classes.Spectrum.getlines">
<tt class="descname">getlines</tt><big>(</big><em>linetype='radio'</em>, <em>**kwargs</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L576" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-576" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectrum.getlines" title="Permalink to this definition">¶</a></dt>
<dd><p>Access a registered database of spectral lines.  Will add an attribute
with the name linetype, which then has properties defined by the
speclines module (most likely, a table and a &#8220;show&#8221; function to display
the lines)</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.classes.Spectrum.interpnans">
<tt class="descname">interpnans</tt><big>(</big><em>spec</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L54" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-54" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectrum.interpnans" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate over NAN values, replacing them with values interpolated from
their neighbors using linear interpolation.</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.classes.Spectrum.measure">
<tt class="descname">measure</tt><big>(</big><em>z=None</em>, <em>d=None</em>, <em>fluxnorm=None</em>, <em>miscline=None</em>, <em>misctol=10.0</em>, <em>ignore=None</em>, <em>derive=True</em>, <em>**kwargs</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L310" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-310" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectrum.measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the measurements class - only do this after you have run a
fitter otherwise pyspeckit will be angry!</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.classes.Spectrum.moments">
<tt class="descname">moments</tt><big>(</big><em>unit='km/s'</em>, <em>**kwargs</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L593" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-593" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectrum.moments" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Return the moments of the spectrum.  In order to assure that the 1st
and 2nd moments are meaningful, a &#8216;default&#8217; unit is set.  If unit is
not set, will use current unit.</p>
<p><em>Documentation imported from the moments module:</em>
Returns (height, amplitude, x, width_x)</p>
</div></blockquote>
<p>the gaussian parameters of a 1D distribution by calculating its
moments.  Depending on the input parameters, will only output 
a subset of the above.
&#8220;height&#8221; is the background level
&#8220;amplitude&#8221; is the maximum (or minimum) of the data after background subtraction
&#8220;x&#8221; is the first moment
&#8220;width_x&#8221; is the second moment</p>
<p>If using masked arrays, pass estimator=np.ma.median
&#8216;estimator&#8217; is used to measure the background level (height)</p>
<p>negamp can be used to force the peak negative (True), positive (False),
or it will be &#8220;autodetected&#8221; (negamp=None)</p>
<dl class="docutils">
<dt>&#8220;nsigcut&#8221; - try to estimate the noise and only use data above/below nsigma</dt>
<dd>above the noise.  Estimate the noise from the data unless passed as a
keyword</dd>
</dl>
<p>Theory:
From first principles (in the absence of noise):
integral(gaussian) = sqrt(2*pi*sigma^2) * amp
sigma = integral / amp / sqrt(2*pi)</p>
<p>in the presence of noise, this gets much more complicated</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.classes.Spectrum.parse_hdf5_header">
<tt class="descname">parse_hdf5_header</tt><big>(</big><em>hdr</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L264" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-264" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectrum.parse_hdf5_header" title="Permalink to this definition">¶</a></dt>
<dd><p>HDF5 reader will create a hdr dictionary from HDF5 dataset attributes
if they exist.  This routine will convert that dict to a pyfits header
instance.</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.classes.Spectrum.parse_header">
<tt class="descname">parse_header</tt><big>(</big><em>hdr</em>, <em>specname=None</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L283" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-283" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectrum.parse_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse parameters from a .fits header into required spectrum structure
parameters</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.classes.Spectrum.parse_text_header">
<tt class="descname">parse_text_header</tt><big>(</big><em>Table</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L229" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-229" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectrum.parse_text_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Grab relevant parameters from a table header (xaxis type, etc)</p>
<p>This function should only exist for Spectrum objects created from
.txt or other atpy table type objects</p>
</dd></dl>

<dl class="attribute">
<dt id="pyspeckit.spectrum.classes.Spectrum.shape">
<tt class="descname">shape</tt><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectrum.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the data shape (a property of the Spectrum)</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.classes.Spectrum.slice">
<tt class="descname">slice</tt><big>(</big><em>start=None</em>, <em>stop=None</em>, <em>units='pixel'</em>, <em>copy=True</em>, <em>preserve_fits=False</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L351" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-351" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectrum.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Slicing the spectrum</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">this is the same as cropping right now, but it returns a
copy instead of cropping inplace</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>start</strong> : numpy.float or int</p>
<blockquote>
<div><p>start of slice</p>
</div></blockquote>
<p><strong>stop</strong> :  numpy.float or int</p>
<blockquote>
<div><p>stop of slice</p>
</div></blockquote>
<p><strong>units</strong> : str</p>
<blockquote>
<div><p>allowed values are any supported physical unit, &#8216;pixel&#8217;</p>
</div></blockquote>
<p><strong>copy</strong> : bool</p>
<blockquote>
<div><p>Return a &#8216;view&#8217; of the data or a copy?</p>
</div></blockquote>
<p><strong>preserve_fits</strong> : bool</p>
<blockquote class="last">
<div><p>Save the fitted parameters from self.fitter?</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.classes.Spectrum.smooth">
<tt class="descname">smooth</tt><big>(</big><em>smooth</em>, <em>**kwargs</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L467" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-467" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectrum.smooth" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Smooth the spectrum by factor <a class="reference internal" href="#pyspeckit.spectrum.classes.Spectrum.smooth" title="pyspeckit.spectrum.classes.Spectrum.smooth"><tt class="xref py py-obj docutils literal"><span class="pre">smooth</span></tt></a>.</p>
<p>Documentation from the <tt class="xref py py-mod docutils literal"><span class="pre">smooth</span></tt> module:</p>
<p>sm.smooth doc:</p>
</div></blockquote>
<p>Smooth and downsample the data array</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>smooth</strong> :  float</p>
<blockquote>
<div><p>Number of pixels to smooth by</p>
</div></blockquote>
<p><strong>smoothtype</strong> : [ &#8216;gaussian&#8217;,&#8217;hanning&#8217;, or &#8216;boxcar&#8217; ]</p>
<blockquote>
<div><p>type of smoothing kernel to use</p>
</div></blockquote>
<p><strong>downsample</strong> :  bool</p>
<blockquote>
<div><p>Downsample the data?</p>
</div></blockquote>
<p><strong>downsample_factor</strong> :  int</p>
<blockquote>
<div><p>Downsample by the smoothing factor, or something else?</p>
</div></blockquote>
<p><strong>convmode</strong> : [ &#8216;full&#8217;,&#8217;valid&#8217;,&#8217;same&#8217; ]</p>
<blockquote class="last">
<div><p>see <tt class="xref py py-mod docutils literal"><span class="pre">numpy.convolve</span></tt>.  &#8216;same&#8217; returns an array of the same length as
&#8216;data&#8217; (assuming data is larger than the kernel)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.classes.Spectrum.stats">
<tt class="descname">stats</tt><big>(</big><em>statrange=()</em>, <em>interactive=False</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L544" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-544" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectrum.stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Return some statistical measures in a dictionary (somewhat self-explanatory)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>statrange</strong> : 2-element tuple</p>
<blockquote>
<div><p>X-range over which to perform measures</p>
</div></blockquote>
<p><strong>interactive</strong> : bool</p>
<blockquote class="last">
<div><p>specify range interactively in plotter</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.classes.Spectrum.write">
<tt class="descname">write</tt><big>(</big><em>filename</em>, <em>type=None</em>, <em>**kwargs</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L209" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-209" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectrum.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the spectrum to a file.  The available file types are listed
in spectrum.writers.writers</p>
<p>type - what type of file to write to?  If not specified, will attempt
to determine type from suffix</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspeckit.spectrum.classes.Spectra">
<em class="property">class </em><tt class="descclassname">pyspeckit.spectrum.classes.</tt><tt class="descname">Spectra</tt><big>(</big><em>speclist</em>, <em>xunits='GHz'</em>, <em>**kwargs</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L675" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-675" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyspeckit.spectrum.classes.Spectrum" title="pyspeckit.spectrum.classes.Spectrum"><tt class="xref py py-class docutils literal"><span class="pre">pyspeckit.spectrum.classes.Spectrum</span></tt></a></p>
<p>A list of individual Spectrum objects.  Intended to be used for
concatenating different wavelength observations of the SAME OBJECT.  Can be
operated on just like any Spectrum object, incuding fitting.  Useful for
fitting multiple lines on non-continguous axes simultaneously.  Be wary of
plotting these though...</p>
<p>Can be indexed like python lists.</p>
<p>X array is forcibly sorted in increasing order</p>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="pyspeckit.spectrum.classes.Spectra.fiteach">
<tt class="descname">fiteach</tt><big>(</big><em>**kwargs</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L775" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-775" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectra.fiteach" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit each spectrum within the Spectra object</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.classes.Spectra.ploteach">
<tt class="descname">ploteach</tt><big>(</big><em>xunits=None</em>, <em>inherit_fit=False</em>, <em>plot_fit=True</em>, <em>plotfitkwargs={}</em>, <em>**plotkwargs</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L792" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-792" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectra.ploteach" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot each spectrum in its own window
inherit_fit - if specified, will grab the fitter &amp; fitter properties from Spectra</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.classes.Spectra.smooth">
<tt class="descname">smooth</tt><big>(</big><em>smooth</em>, <em>**kwargs</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L760" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-760" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.Spectra.smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooth the spectrum by factor &#8220;smooth&#8221;.  Options are defined in sm.smooth</p>
<p>because &#8216;Spectra&#8217; does not have a header attribute, don&#8217;t do anything to it...</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyspeckit.spectrum.classes.ObsBlock">
<em class="property">class </em><tt class="descclassname">pyspeckit.spectrum.classes.</tt><tt class="descname">ObsBlock</tt><big>(</big><em>speclist</em>, <em>xtype='frequency'</em>, <em>xarr=None</em>, <em>force=False</em>, <em>**kwargs</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L811" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-811" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.ObsBlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyspeckit.spectrum.classes.Spectra" title="pyspeckit.spectrum.classes.Spectra"><tt class="xref py py-class docutils literal"><span class="pre">pyspeckit.spectrum.classes.Spectra</span></tt></a></p>
<p>An Observation Block</p>
<p>Consists of multiple spectra with a shared X-axis.  Intended to hold groups
of observations of the same object in the same setup for later averaging.</p>
<p>ObsBlocks can be indexed like python lists.</p>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="pyspeckit.spectrum.classes.ObsBlock.average">
<tt class="descname">average</tt><big>(</big><em>weight=None</em>, <em>inverse_weight=False</em>, <em>error='erravgrtn'</em>, <em>debug=False</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L856" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-856" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.ObsBlock.average" title="Permalink to this definition">¶</a></dt>
<dd><p>Average all scans in an ObsBlock.  Returns a single Spectrum object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>weight</strong> : string</p>
<blockquote>
<div><p>a header keyword to weight by.   If not specified, the spectra will be 
averaged without weighting</p>
</div></blockquote>
<p><strong>inverse_weight</strong> : bool</p>
<blockquote>
<div><p>Is the header keyword an inverse-weight (e.g., a variance?)</p>
</div></blockquote>
<p><strong>error</strong> : [&#8216;scanrms&#8217;,&#8217;erravg&#8217;,&#8217;erravgrtn&#8217;]</p>
<blockquote class="last">
<div><p>estimate the error spectrum by one of three methods.
&#8216;scanrms&#8217;   : the standard deviation of each pixel across all scans
&#8216;erravg&#8217;    : the average of all input error spectra
&#8216;erravgrtn&#8217; : the average of all input error spectra divided by sqrt(n_obs)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.classes.ObsBlock.smooth">
<tt class="descname">smooth</tt><big>(</big><em>smooth</em>, <em>**kwargs</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum/classes.py#L925" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum/classes.py#cl-925" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.classes.ObsBlock.smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooth the spectrum by factor &#8220;smooth&#8221;.  Options are defined in sm.smooth</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-pyspeckit.spectrum"></span><dl class="function">
<dt id="pyspeckit.spectrum.register_reader">
<tt class="descclassname">pyspeckit.spectrum.</tt><tt class="descname">register_reader</tt><big>(</big><em>filetype</em>, <em>function</em>, <em>suffix</em>, <em>default=False</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum.py#L16" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum.py#cl-16" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.register_reader" title="Permalink to this definition">¶</a></dt>
<dd><p>Register a reader function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>filetype: str</strong> :</p>
<blockquote>
<div><p>The file type name</p>
</div></blockquote>
<p><strong>function: function</strong> :</p>
<blockquote>
<div><p>The reader function.  Should take a filename as input and return an
X-axis object (see units.py), a spectrum, an error spectrum (initialize
it to 0&#8217;s if empty), and a pyfits header instance</p>
</div></blockquote>
<p><strong>suffix: int</strong> :</p>
<blockquote class="last">
<div><p>What suffix should the file have?</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyspeckit.spectrum.register_writer">
<tt class="descclassname">pyspeckit.spectrum.</tt><tt class="descname">register_writer</tt><big>(</big><em>filetype</em>, <em>function</em>, <em>suffix</em>, <em>default=False</em><big>)</big><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/pyspeckit/spectrum.py#L53" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[github]</span></a><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/pyspeckit/spectrum.py#cl-53" title="Push the Edit button on the next page"><span class="edit-on-bitbucket viewcode-link">&nbsp;[bitbucket]</span></a><a class="headerlink" href="#pyspeckit.spectrum.register_writer" title="Permalink to this definition">¶</a></dt>
<dd><p>Register a writer function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>filetype:  string</strong> :</p>
<blockquote>
<div><p>The file type name</p>
</div></blockquote>
<p><strong>function:  function</strong> :</p>
<blockquote>
<div><p>The writer function.  Will be an attribute of Spectrum
object, and called as spectrum.Spectrum.write_hdf5(), 
for example.</p>
</div></blockquote>
<p><strong>suffix:  int</strong> :</p>
<blockquote class="last">
<div><p>What suffix should the file have?</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="edit-section section">
<p class="edit-on-github-para"><a class="reference external" href="http://github.com/keflavich/pyspeckit/tree/master/doc/spectrum.rst" title="Push the Edit button on the next page"><span class="edit-on-github">[edit this page on github]</span></a></p>
<p class="edit-on-bitbucket-para"><a class="reference external" href="http://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/src/tip/doc/spectrum.rst" title="Push the Edit button on the next page"><span class="edit-on-bitbucket">[edit this page on bitbucket]</span></a></p>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          
          <h3 style="margin-top: 1.5em;">Search</h3>
          <form class="search" action="search.html" method="get">
            <input type="text" name="q" />
            <input type="submit" value="Go" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
          <p class="searchtip" style="font-size: 90%">
            Enter search terms or a module, class or function name.
          </p>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer">
    <table width=800><tr>
            <td align=left>
      &copy; Copyright 2011, Adam Ginsburg and Jordan Mirocha.
    </td>
    <td align=right><a href="mailto:pyspeckit@gmail.com">Contact us</a></td>
    </tr>
    <tr><td>
      Last updated on May 04, 2013.
    </td><td align=right>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
    </td>
    <tr>
            <td align=left><a href="pyspeckit.pdf">PDF version of this document</a></td>
    </tr></table>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-6253200-7']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
        
    </div>
  </body>
</html>