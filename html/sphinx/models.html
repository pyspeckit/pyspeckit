

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Models &mdash; pyspeckit 0.1.8 documentation</title>
    
    <link rel="stylesheet" href="_static/extra.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1.8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/logo.ico"/>
    <link rel="top" title="pyspeckit 0.1.8 documentation" href="index.html" />
    <link rel="next" title="Features" href="features.html" />
    <link rel="prev" title="Installation and Requirements" href="install.html" />
     
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setDomainName', 'pyspeckit.bitbucket.org']);
      _gaq.push(['_setAllowHash', false]);
      _gaq.push(['_trackPageview']);


    </script>
    <link rel="stylesheet" type="text/css" href="_static/extra.css" />
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
          <p class="logo"><a href="http://pyspeckit.bitbucket.org">
            <img class="logo" src="_static/logo.png" alt="Logo"/>
          </a></p>
        <h1><a href="index.html">pyspeckit 0.1.8 documentation</a></h1>
        <div class="rel">
          <a href="http://pyspeckit.bitbucket.org/">PySpecKit Home </a>  |
          <a href=index.html>Docs Home </a>  |
          <a href="https://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/overview">Bitbucket Home </a>  |
          <a href="https://bitbucket.org/pyspeckit/pyspeckit.bitbucket.org/wiki/Home">Wiki</a>  |
          <a href=search.html>Search </a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-pyspeckit.spectrum.models">
<span id="models"></span><h1>Models<a class="headerlink" href="#module-pyspeckit.spectrum.models" title="Permalink to this headline">¶</a></h1>
<p>The generic SpectralModel class is a wrapper for model functions.  A model
should take in an X-axis and some number of parameters.  In order to declare a
SpectralModel, you give SpectralModel the function name and the number of
parameters it requires.  The rest of the options are optional, though parnames
&amp; shortvarnames are strongly recommended.  If you do not specify fitunits,
your fitting code must deal with units internally.</p>
<p>Here are some examples of how to make your own fitters:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">hill5_fitter</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">SpectralModel</span><span class="p">(</span><span class="n">hill5_model</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">parnames</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;tau&#39;</span><span class="p">,</span> <span class="s">&#39;v_lsr&#39;</span><span class="p">,</span>  <span class="s">&#39;v_infall&#39;</span><span class="p">,</span>  <span class="s">&#39;sigma&#39;</span><span class="p">,</span> <span class="s">&#39;tpeak&#39;</span><span class="p">],</span>
        <span class="n">parlimited</span><span class="o">=</span><span class="p">[(</span><span class="bp">True</span><span class="p">,</span><span class="bp">False</span><span class="p">),(</span><span class="bp">False</span><span class="p">,</span><span class="bp">False</span><span class="p">),(</span><span class="bp">True</span><span class="p">,</span><span class="bp">False</span><span class="p">),(</span><span class="bp">True</span><span class="p">,</span><span class="bp">False</span><span class="p">),</span> <span class="p">(</span><span class="bp">True</span><span class="p">,</span><span class="bp">False</span><span class="p">)],</span>
        <span class="n">parlimits</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
        <span class="c"># specify the parameter names (TeX is OK)</span>
        <span class="n">shortvarnames</span><span class="o">=</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">tau&quot;</span><span class="p">,</span><span class="s">&quot;v_{lsr}&quot;</span><span class="p">,</span><span class="s">&quot;v_{infall}&quot;</span><span class="p">,</span><span class="s">&quot;</span><span class="se">\\</span><span class="s">sigma&quot;</span><span class="p">,</span><span class="s">&quot;T_{peak}&quot;</span><span class="p">),</span>
        <span class="n">fitunits</span><span class="o">=</span><span class="s">&#39;Hz&#39;</span> <span class="p">)</span>

<span class="n">gaussfitter</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">SpectralModel</span><span class="p">(</span><span class="n">gaussian</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">parnames</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;amplitude&#39;</span><span class="p">,</span><span class="s">&#39;shift&#39;</span><span class="p">,</span><span class="s">&#39;width&#39;</span><span class="p">],</span>
        <span class="n">parlimited</span><span class="o">=</span><span class="p">[(</span><span class="bp">False</span><span class="p">,</span><span class="bp">False</span><span class="p">),(</span><span class="bp">False</span><span class="p">,</span><span class="bp">False</span><span class="p">),(</span><span class="bp">True</span><span class="p">,</span><span class="bp">False</span><span class="p">)],</span>
        <span class="n">parlimits</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
        <span class="n">shortvarnames</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;A&#39;</span><span class="p">,</span><span class="s">r&#39;\Delta x&#39;</span><span class="p">,</span><span class="s">r&#39;\sigma&#39;</span><span class="p">),</span>
        <span class="n">multisingle</span><span class="o">=</span><span class="n">multisingle</span><span class="p">,</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>Then you can <a class="reference external" href="registration.html">register</a> these fitters.</p>
<span class="target" id="module-pyspeckit.spectrum.models.model"></span><dl class="class">
<dt id="pyspeckit.spectrum.models.model.SpectralModel">
<em class="property">class </em><tt class="descclassname">pyspeckit.spectrum.models.model.</tt><tt class="descname">SpectralModel</tt><big>(</big><em>modelfunc</em>, <em>npars</em>, <em>shortvarnames=('A'</em>, <em>'\Delta x'</em>, <em>'\sigma')</em>, <em>multisingle='multi'</em>, <em>fitunits=None</em>, <em>use_lmfit=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.model.SpectralModel" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper class for a spectra model.  Includes internal functions to
generate multi-component models, annotations, integrals, and individual
components.  The declaration can be complex, since you should name
individual variables, set limits on them, set the units the fit will be
performed in, and set the annotations to be used.  Check out some
of the hyperfine codes (hcn, n2hp) for examples.</p>
<p class="rubric">Methods</p>
<p>Spectral Model Initialization</p>
<p>Create a Spectral Model class for data fitting</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>modelfunc</strong> : function</p>
<blockquote>
<div><p>the model function to be fitted.  Should take an X-axis
(spectroscopic axis) as an input followed by input parameters.
Returns an array with the same shape as the input X-axis</p>
</div></blockquote>
<p><strong>npars</strong> : int</p>
<blockquote>
<div><p>number of parameters required by the model</p>
</div></blockquote>
<p><strong>parnames</strong> : list (optional)</p>
<blockquote>
<div><p>a list or tuple of the parameter names</p>
</div></blockquote>
<p><strong>parvalues</strong> : list (optional)</p>
<blockquote>
<div><p>the initial guesses for the input parameters (defaults to ZEROS)</p>
</div></blockquote>
<p><strong>parlimits</strong> :  list (optional)</p>
<blockquote>
<div><p>the upper/lower limits for each variable     (defaults to ZEROS)</p>
</div></blockquote>
<p><strong>parfixed</strong> : list (optional)</p>
<blockquote>
<div><p>Can declare any variables to be fixed        (defaults to ZEROS)</p>
</div></blockquote>
<p><strong>parerror</strong> : list (optional)</p>
<blockquote>
<div><p>technically an output parameter... hmm       (defaults to ZEROS)</p>
</div></blockquote>
<p><strong>partied</strong> : list (optional)</p>
<blockquote>
<div><p>not the past tense of party.  Can declare, via text, that
some parameters are tied to each other.  Defaults to zeros like the
others, but it&#8217;s not clear if that&#8217;s a sensible default</p>
</div></blockquote>
<p><strong>fitunits</strong> : list (optional)</p>
<blockquote>
<div><p>convert X-axis to these units before passing to model</p>
</div></blockquote>
<p><strong>parsteps</strong> : list (optional)</p>
<blockquote>
<div><p>minimum step size for each paremeter          (defaults to ZEROS)</p>
</div></blockquote>
<p><strong>npeaks</strong> : list (optional)</p>
<blockquote>
<div><p>default number of peaks to assume when fitting (can be overridden)</p>
</div></blockquote>
<p><strong>shortvarnames</strong> : list (optional)</p>
<blockquote>
<div><p>TeX names of the variables to use when annotating</p>
</div></blockquote>
<p><strong>multisingle</strong> : list (optional)</p>
<blockquote>
<div><p>Are there multiple peaks (no background will be fit) or
just a single peak (a background may/will be fit)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>A tuple containing (model best-fit parameters, the model, parameter</strong> :</p>
<p class="last"><strong>errors, chi^2 value)</strong> :</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="pyspeckit.spectrum.models.model.SpectralModel.annotations">
<tt class="descname">annotations</tt><big>(</big><em>shortvarnames=None</em>, <em>debug=False</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.model.SpectralModel.annotations" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of TeX-formatted labels</p>
<p>The values and errors are formatted so that only the significant digits
are displayed.  Rounding is performed using the decimal package.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>shortvarnames</strong> : list</p>
<blockquote class="last">
<div><p>A list of variable names (tex is allowed) to include in the
annotations.  Defaults to self.shortvarnames</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Annotate a Gaussian</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">specfit</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">shortvarnames</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;A&#39;</span><span class="p">,</span><span class="s">&#39;\Delta x&#39;</span><span class="p">,</span><span class="s">&#39;\sigma&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.models.model.SpectralModel.components">
<tt class="descname">components</tt><big>(</big><em>xarr</em>, <em>pars</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.model.SpectralModel.components" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy ndarray of shape [npeaks x modelshape] of the
independent components of the fits</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.models.model.SpectralModel.fitter">
<tt class="descname">fitter</tt><big>(</big><em>xax</em>, <em>data</em>, <em>err=None</em>, <em>quiet=True</em>, <em>veryverbose=False</em>, <em>debug=False</em>, <em>parinfo=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.model.SpectralModel.fitter" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the fitter using mpfit.</p>
<p>kwargs will be passed to _make_parinfo and mpfit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>xax</strong> : SpectroscopicAxis</p>
<blockquote>
<div><p>The X-axis of the spectrum</p>
</div></blockquote>
<p><strong>data</strong> : ndarray</p>
<blockquote>
<div><p>The data to fit</p>
</div></blockquote>
<p><strong>err</strong> : ndarray (optional)</p>
<blockquote>
<div><p>The error on the data.  If unspecified, will be uniform unity</p>
</div></blockquote>
<p><strong>parinfo</strong> : ParinfoList</p>
<blockquote>
<div><p>The guesses, parameter limits, etc.  See
<cite>pyspeckit.spectrum.parinfo</cite> for details</p>
</div></blockquote>
<p><strong>quiet</strong> : bool</p>
<blockquote>
<div><p>pass to mpfit.  If False, will print out the parameter values for
each iteration of the fitter</p>
</div></blockquote>
<p><strong>veryverbose</strong> : bool</p>
<blockquote>
<div><p>print out a variety of mpfit output parameters</p>
</div></blockquote>
<p><strong>debug</strong> : bool</p>
<blockquote class="last">
<div><p>raise an exception (rather than a warning) if chi^2 is nan</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.models.model.SpectralModel.get_emcee_ensemblesampler">
<tt class="descname">get_emcee_ensemblesampler</tt><big>(</big><em>xarr</em>, <em>data</em>, <em>error</em>, <em>nwalkers</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.model.SpectralModel.get_emcee_ensemblesampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an emcee walker ensemble for the data &amp; model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>data</strong> : np.ndarray</p>
<p><strong>error</strong> : np.ndarray</p>
<p><strong>nwalkers</strong> : int</p>
<blockquote class="last">
<div><p>Number of walkers to use</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyspeckit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">pyspeckit</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">SpectroscopicAxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span> <span class="n">unit</span><span class="o">=</span><span class="s">&#39;km/s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="n">e</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">pyspeckit</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">xarr</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">specfit</span><span class="p">(</span><span class="n">fittype</span><span class="o">=</span><span class="s">&#39;gaussian&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nwalkers</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">specfit</span><span class="o">.</span><span class="n">fitter</span><span class="o">.</span><span class="n">npars</span> <span class="o">*</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emcee_ensemble</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">specfit</span><span class="o">.</span><span class="n">fitter</span><span class="o">.</span><span class="n">get_emcee_ensemblesampler</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">xarr</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="n">nwalkers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sp</span><span class="o">.</span><span class="n">specfit</span><span class="o">.</span><span class="n">parinfo</span><span class="o">.</span><span class="n">values</span><span class="p">]</span> <span class="o">*</span> <span class="n">nwalkers</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p0</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="o">*</span><span class="n">p0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">/</span> <span class="mf">10.</span> <span class="o">+</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pos</span><span class="p">,</span><span class="n">logprob</span><span class="p">,</span><span class="n">state</span> <span class="o">=</span> <span class="n">emcee_ensemble</span><span class="o">.</span><span class="n">run_mcmc</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.models.model.SpectralModel.get_emcee_sampler">
<tt class="descname">get_emcee_sampler</tt><big>(</big><em>xarr</em>, <em>data</em>, <em>error</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.model.SpectralModel.get_emcee_sampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an emcee walker for the data &amp; model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>xarr</strong> : pyspeckit.units.SpectroscopicAxis</p>
<p><strong>data</strong> : np.ndarray</p>
<p class="last"><strong>error</strong> : np.ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyspeckit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">pyspeckit</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">SpectroscopicAxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span> <span class="n">unit</span><span class="o">=</span><span class="s">&#39;km/s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="n">e</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">pyspeckit</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">xarr</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">specfit</span><span class="p">(</span><span class="n">fittype</span><span class="o">=</span><span class="s">&#39;gaussian&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emcee_sampler</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">specfit</span><span class="o">.</span><span class="n">fitter</span><span class="o">.</span><span class="n">get_emcee_sampler</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">xarr</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">error</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p0</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">specfit</span><span class="o">.</span><span class="n">parinfo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emcee_sampler</span><span class="o">.</span><span class="n">run_mcmc</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.models.model.SpectralModel.get_pymc">
<tt class="descname">get_pymc</tt><big>(</big><em>xarr</em>, <em>data</em>, <em>error</em>, <em>use_fitted_values=False</em>, <em>inf=inf</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.model.SpectralModel.get_pymc" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pymc MCMC sampler.  Defaults to &#8216;uninformative&#8217; priors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>data</strong> : np.ndarray</p>
<p><strong>error</strong> : np.ndarray</p>
<p><strong>use_fitted_values</strong> : bool</p>
<blockquote class="last">
<div><p>Each parameter with a measured error will have a prior defined by
the Normal distribution with sigma = par.error and mean = par.value</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">pyspeckit</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">SpectroscopicAxis</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span> <span class="n">unit</span><span class="o">=</span><span class="s">&#39;km/s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="n">e</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">pyspeckit</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">xarr</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">specfit</span><span class="p">(</span><span class="n">fittype</span><span class="o">=</span><span class="s">&#39;gaussian&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MCuninformed</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">specfit</span><span class="o">.</span><span class="n">fitter</span><span class="o">.</span><span class="n">get_pymc</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">xarr</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">error</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MCwithpriors</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">specfit</span><span class="o">.</span><span class="n">fitter</span><span class="o">.</span><span class="n">get_pymc</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">xarr</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="n">use_fitted_values</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MCuninformed</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MCuninformed</span><span class="o">.</span><span class="n">stats</span><span class="p">()[</span><span class="s">&#39;AMPLITUDE0&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># WARNING: This will fail because width cannot be set &lt;0, but it may randomly reach that...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># How do you define a likelihood distribution with a lower limit?!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MCwithpriors</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MCwithpriors</span><span class="o">.</span><span class="n">stats</span><span class="p">()[</span><span class="s">&#39;AMPLITUDE0&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.models.model.SpectralModel.integral">
<tt class="descname">integral</tt><big>(</big><em>modelpars</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.model.SpectralModel.integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Extremely simple integrator:
IGNORES modelpars;
just sums self.model</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.models.model.SpectralModel.lmfitfun">
<tt class="descname">lmfitfun</tt><big>(</big><em>x</em>, <em>y</em>, <em>err=None</em>, <em>debug=False</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.model.SpectralModel.lmfitfun" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function to compute the fit residuals in an lmfit-friendly format</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.models.model.SpectralModel.lmfitter">
<tt class="descname">lmfitter</tt><big>(</big><em>xax</em>, <em>data</em>, <em>err=None</em>, <em>parinfo=None</em>, <em>quiet=True</em>, <em>debug=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.model.SpectralModel.lmfitter" title="Permalink to this definition">¶</a></dt>
<dd><p>Use lmfit instead of mpfit to do the fitting</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>xax</strong> : SpectroscopicAxis</p>
<blockquote>
<div><p>The X-axis of the spectrum</p>
</div></blockquote>
<p><strong>data</strong> : ndarray</p>
<blockquote>
<div><p>The data to fit</p>
</div></blockquote>
<p><strong>err</strong> : ndarray (optional)</p>
<blockquote>
<div><p>The error on the data.  If unspecified, will be uniform unity</p>
</div></blockquote>
<p><strong>parinfo</strong> : ParinfoList</p>
<blockquote>
<div><p>The guesses, parameter limits, etc.  See
<cite>pyspeckit.spectrum.parinfo</cite> for details</p>
</div></blockquote>
<p><strong>quiet</strong> : bool</p>
<blockquote class="last">
<div><p>If false, print out some messages about the fitting</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.models.model.SpectralModel.logp">
<tt class="descname">logp</tt><big>(</big><em>xarr</em>, <em>data</em>, <em>error</em>, <em>pars=None</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.model.SpectralModel.logp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the log probability of the model</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.models.model.SpectralModel.mpfitfun">
<tt class="descname">mpfitfun</tt><big>(</big><em>x</em>, <em>y</em>, <em>err=None</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.model.SpectralModel.mpfitfun" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper function to compute the fit residuals in an mpfit-friendly format</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.models.model.SpectralModel.n_modelfunc">
<tt class="descname">n_modelfunc</tt><big>(</big><em>pars=None</em>, <em>debug=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.model.SpectralModel.n_modelfunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple wrapper to deal with N independent peaks for a given spectral model</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.models.model.SpectralModel.slope">
<tt class="descname">slope</tt><big>(</big><em>xinp</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.model.SpectralModel.slope" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the local slope of the model at location x
(x must be in xax&#8217;s units)</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-pyspeckit.spectrum.models.ammonia"></span><p>Ammonia inversion transition TKIN fitter translated from Erik Rosolowsky&#8217;s
<a class="reference external" href="http://svn.ok.ubc.ca/svn/signals/nh3fit/">http://svn.ok.ubc.ca/svn/signals/nh3fit/</a></p>
<div class="section" id="module-api">
<h2>Module API<a class="headerlink" href="#module-api" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyspeckit.spectrum.models.ammonia.ammonia">
<tt class="descclassname">pyspeckit.spectrum.models.ammonia.</tt><tt class="descname">ammonia</tt><big>(</big><em>xarr</em>, <em>tkin=20</em>, <em>tex=None</em>, <em>ntot=100000000000000.0</em>, <em>width=1</em>, <em>xoff_v=0.0</em>, <em>fortho=0.0</em>, <em>tau=None</em>, <em>fillingfraction=None</em>, <em>return_tau=False</em>, <em>thin=False</em>, <em>verbose=False</em>, <em>return_components=False</em>, <em>debug=False</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.ammonia.ammonia" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a model Ammonia spectrum based on input temperatures, column, and
gaussian parameters</p>
<p>ntot can be specified as a column density (e.g., 10^15) or a log-column-density (e.g., 15)</p>
<dl class="docutils">
<dt>tex can be specified or can be assumed LTE if unspecified, if tex&gt;tkin, or if &#8220;thin&#8221;</dt>
<dd>is specified</dd>
<dt>&#8220;thin&#8221; uses a different parametetrization and requires only the optical depth, width, offset,</dt>
<dd>and tkin to be specified.  In the &#8216;thin&#8217; approximation, tex is not used in computation of
the partition function - LTE is implicitly assumed</dd>
</dl>
<p>If tau is specified, ntot is NOT fit but is set to a fixed value
fillingfraction is an arbitrary scaling factor to apply to the model
fortho is the ortho/(ortho+para) fraction.  The default is to assume all ortho.
xoff_v is the velocity offset in km/s</p>
<p>tau refers to the optical depth of the 1-1 line.  The optical depths of the
other lines are fixed relative to tau_oneone</p>
<p>(not implemented) if tau is specified, ntot is ignored</p>
</dd></dl>

</div>
<span class="target" id="module-pyspeckit.spectrum.models.fitter"></span><p>Adds a variable height (background) component to any model</p>
<span class="target" id="module-pyspeckit.spectrum.models.formaldehyde"></span><p>This is a formaldehyde 1_11-1_10 / 2_12-2_11 fitter.  It includes hyperfine
components of the formaldehyde lines and has both LTE and RADEX LVG based
models</p>
<dl class="function">
<dt id="pyspeckit.spectrum.models.formaldehyde.formaldehyde">
<tt class="descclassname">pyspeckit.spectrum.models.formaldehyde.</tt><tt class="descname">formaldehyde</tt><big>(</big><em>xarr</em>, <em>amp=1.0</em>, <em>xoff_v=0.0</em>, <em>width=1.0</em>, <em>return_hyperfine_components=False</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.formaldehyde.formaldehyde" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a model Formaldehyde spectrum based on simple gaussian parameters</p>
<p>the &#8220;amplitude&#8221; is an essentially arbitrary parameter; we therefore define it to be Tex given tau=0.01 when
passing to the fitter
The final spectrum is then rescaled to that value</p>
</dd></dl>

<dl class="function">
<dt id="pyspeckit.spectrum.models.formaldehyde.formaldehyde_radex">
<tt class="descclassname">pyspeckit.spectrum.models.formaldehyde.</tt><tt class="descname">formaldehyde_radex</tt><big>(</big><em>xarr</em>, <em>density=4</em>, <em>column=13</em>, <em>xoff_v=0.0</em>, <em>width=1.0</em>, <em>grid_vwidth=1.0</em>, <em>grid_vwidth_scale=False</em>, <em>texgrid=None</em>, <em>taugrid=None</em>, <em>hdr=None</em>, <em>path_to_texgrid=''</em>, <em>path_to_taugrid=''</em>, <em>temperature_gridnumber=3</em>, <em>debug=False</em>, <em>verbose=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.formaldehyde.formaldehyde_radex" title="Permalink to this definition">¶</a></dt>
<dd><p>Use a grid of RADEX-computed models to make a model line spectrum</p>
<p>The RADEX models have to be available somewhere.
OR they can be passed as arrays.  If as arrays, the form should be:
texgrid = ((minfreq1,maxfreq1,texgrid1),(minfreq2,maxfreq2,texgrid2))</p>
<p>xarr must be a SpectroscopicAxis instance
xoff_v, width are both in km/s</p>
<dl class="docutils">
<dt>grid_vwidth is the velocity assumed when computing the grid in km/s</dt>
<dd>this is important because tau = modeltau / width (see, e.g., 
Draine 2011 textbook pgs 219-230)</dd>
</dl>
<p>grid_vwidth_scale is True or False: False for LVG, True for Sphere</p>
</dd></dl>

<dl class="function">
<dt id="pyspeckit.spectrum.models.formaldehyde.formaldehyde_radex_orthopara_temp">
<tt class="descclassname">pyspeckit.spectrum.models.formaldehyde.</tt><tt class="descname">formaldehyde_radex_orthopara_temp</tt><big>(</big><em>xarr</em>, <em>density=4</em>, <em>column=13</em>, <em>orthopara=1.0</em>, <em>temperature=15.0</em>, <em>xoff_v=0.0</em>, <em>width=1.0</em>, <em>grid_vwidth=1.0</em>, <em>grid_vwidth_scale=False</em>, <em>texgrid=None</em>, <em>taugrid=None</em>, <em>hdr=None</em>, <em>path_to_texgrid=''</em>, <em>path_to_taugrid=''</em>, <em>debug=False</em>, <em>verbose=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.formaldehyde.formaldehyde_radex_orthopara_temp" title="Permalink to this definition">¶</a></dt>
<dd><p>Use a grid of RADEX-computed models to make a model line spectrum</p>
<p>The RADEX models have to be available somewhere.
OR they can be passed as arrays.  If as arrays, the form should be:
texgrid = ((minfreq1,maxfreq1,texgrid1),(minfreq2,maxfreq2,texgrid2))</p>
<p>xarr must be a SpectroscopicAxis instance
xoff_v, width are both in km/s</p>
<dl class="docutils">
<dt>grid_vwidth is the velocity assumed when computing the grid in km/s</dt>
<dd>this is important because tau = modeltau / width (see, e.g., 
Draine 2011 textbook pgs 219-230)</dd>
</dl>
<p>grid_vwidth_scale is True or False: False for LVG, True for Sphere</p>
</dd></dl>

<span class="target" id="module-pyspeckit.spectrum.models.inherited_gaussfitter"></span><p>The simplest and most useful model.</p>
<p>Until 12/23/2011, gaussian fitting used the complicated and somewhat bloated
gaussfitter.py code.  Now, this is a great example of how to make your own
model!  Just make a function like gaussian and plug it into the SpectralModel
class.</p>
<dl class="function">
<dt id="pyspeckit.spectrum.models.inherited_gaussfitter.gaussian">
<tt class="descclassname">pyspeckit.spectrum.models.inherited_gaussfitter.</tt><tt class="descname">gaussian</tt><big>(</big><em>x</em>, <em>A</em>, <em>dx</em>, <em>w</em>, <em>return_components=False</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.inherited_gaussfitter.gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a 1-dimensional gaussian of form
H+A*numpy.exp(-(x-dx)**2/(2*w**2))</p>
<p>[height,amplitude,center,width]</p>
<p>return_components does nothing but is required by all fitters</p>
</dd></dl>

<dl class="function">
<dt id="pyspeckit.spectrum.models.inherited_gaussfitter.gaussian_fitter">
<tt class="descclassname">pyspeckit.spectrum.models.inherited_gaussfitter.</tt><tt class="descname">gaussian_fitter</tt><big>(</big><em>multisingle='multi'</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.inherited_gaussfitter.gaussian_fitter" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator for Gaussian fitter class</p>
</dd></dl>

<span class="target" id="module-pyspeckit.spectrum.models.hcn"></span><p>This is an HCN fitter...
ref for line params: <a class="reference external" href="http://www.strw.leidenuniv.nl/~moldata/datafiles/hcn&#64;hfs.dat">http://www.strw.leidenuniv.nl/~moldata/datafiles/hcn&#64;hfs.dat</a></p>
<dl class="data">
<dt id="pyspeckit.spectrum.models.hcn.aval_dict">
<tt class="descclassname">pyspeckit.spectrum.models.hcn.</tt><tt class="descname">aval_dict</tt><em class="property"> = {'10-01': 2.4075e-05, '12-01': 2.4075e-05, '11-01': 2.4075e-05}</em><a class="headerlink" href="#pyspeckit.spectrum.models.hcn.aval_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Line strengths of the 15 hyperfine components in J = 1 -  0  transition. The
thickness of the lines indicates their relative weight compared to the others.
Line strengths are normalized in such a way that summing over all initial J = 1
levels gives the degeneracy of the  J = 0 levels, i.e.,  for JF1F = 012,
three for JF1F = 011, and one for JF1F = 010. Thus, the sum over all 15
transitions gives the total spin degeneracy</p>
</dd></dl>

<dl class="function">
<dt id="pyspeckit.spectrum.models.hcn.hcn_radex">
<tt class="descclassname">pyspeckit.spectrum.models.hcn.</tt><tt class="descname">hcn_radex</tt><big>(</big><em>xarr</em>, <em>density=4</em>, <em>column=13</em>, <em>xoff_v=0.0</em>, <em>width=1.0</em>, <em>grid_vwidth=1.0</em>, <em>grid_vwidth_scale=False</em>, <em>texgrid=None</em>, <em>taugrid=None</em>, <em>hdr=None</em>, <em>path_to_texgrid=''</em>, <em>path_to_taugrid=''</em>, <em>temperature_gridnumber=3</em>, <em>debug=False</em>, <em>verbose=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.hcn.hcn_radex" title="Permalink to this definition">¶</a></dt>
<dd><p>Use a grid of RADEX-computed models to make a model line spectrum</p>
<p>The RADEX models have to be available somewhere.
OR they can be passed as arrays.  If as arrays, the form should be:
texgrid = ((minfreq1,maxfreq1,texgrid1),(minfreq2,maxfreq2,texgrid2))</p>
<p>xarr must be a SpectroscopicAxis instance
xoff_v, width are both in km/s</p>
<dl class="docutils">
<dt>grid_vwidth is the velocity assumed when computing the grid in km/s</dt>
<dd>this is important because tau = modeltau / width (see, e.g., 
Draine 2011 textbook pgs 219-230)</dd>
</dl>
<p>grid_vwidth_scale is True or False: False for LVG, True for Sphere</p>
</dd></dl>

<span class="target" id="module-pyspeckit.spectrum.models.hill5infall"></span><p>Code translated from:
<a class="reference external" href="https://bitbucket.org/devries/analytic_infall/overview">https://bitbucket.org/devries/analytic_infall/overview</a></p>
<p>Original source:
<a class="reference external" href="http://adsabs.harvard.edu/abs/2005ApJ...620..800D">http://adsabs.harvard.edu/abs/2005ApJ...620..800D</a></p>
<dl class="function">
<dt id="pyspeckit.spectrum.models.hill5infall.hill5_model">
<tt class="descclassname">pyspeckit.spectrum.models.hill5infall.</tt><tt class="descname">hill5_model</tt><big>(</big><em>xarr</em>, <em>tau</em>, <em>v_lsr</em>, <em>v_infall</em>, <em>sigma</em>, <em>tpeak</em>, <em>TBG=2.73</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.hill5infall.hill5_model" title="Permalink to this definition">¶</a></dt>
<dd><p>The rest of this needs to be translated from C</p>
</dd></dl>

<dl class="function">
<dt id="pyspeckit.spectrum.models.hill5infall.jfunc">
<tt class="descclassname">pyspeckit.spectrum.models.hill5infall.</tt><tt class="descname">jfunc</tt><big>(</big><em>t</em>, <em>nu</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.hill5infall.jfunc" title="Permalink to this definition">¶</a></dt>
<dd><p>t- kelvin
nu - Hz?</p>
</dd></dl>

<span class="target" id="module-pyspeckit.spectrum.models.hyperfine"></span><dl class="class">
<dt id="pyspeckit.spectrum.models.hyperfine.hyperfinemodel">
<em class="property">class </em><tt class="descclassname">pyspeckit.spectrum.models.hyperfine.</tt><tt class="descname">hyperfinemodel</tt><big>(</big><em>line_names</em>, <em>voff_lines_dict</em>, <em>freq_dict</em>, <em>line_strength_dict</em>, <em>relative_strength_total_degeneracy</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.hyperfine.hyperfinemodel" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for the hyperfine model class.  Specify the offsets and relative
strengths when initializing, then you&#8217;ve got yourself a hyperfine modeler.</p>
<p class="rubric">Methods</p>
<p>Initialize the various parameters defining the hyperfine transitions</p>
<p>line_names is a LIST of the line names to be used as indices for the dictionaries</p>
<dl class="docutils">
<dt>voff_lines_dict is a linename:v_off dictionary of velocity offsets for the hyperfine components.  Technically,</dt>
<dd>this is redundant with freq_dict</dd>
</dl>
<p>freq_dict - frequencies of the indvidual transitions</p>
<dl class="docutils">
<dt>line_strength_dict - Relative strengths of the hyperfine components, usually determined by their degeneracy and </dt>
<dd>Einstein A coefficients</dd>
</dl>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="pyspeckit.spectrum.models.hyperfine.hyperfinemodel.hyperfine">
<tt class="descname">hyperfine</tt><big>(</big><em>xarr</em>, <em>Tex=5.0</em>, <em>tau=0.1</em>, <em>xoff_v=0.0</em>, <em>width=1.0</em>, <em>return_hyperfine_components=False</em>, <em>Tbackground=2.73</em>, <em>amp=None</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.hyperfine.hyperfinemodel.hyperfine" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a model spectrum given an excitation temperature, optical depth, offset velocity, and velocity width.</p>
</dd></dl>

<dl class="method">
<dt id="pyspeckit.spectrum.models.hyperfine.hyperfinemodel.hyperfine_amp">
<tt class="descname">hyperfine_amp</tt><big>(</big><em>xarr</em>, <em>amp=None</em>, <em>xoff_v=0.0</em>, <em>width=1.0</em>, <em>return_hyperfine_components=False</em>, <em>Tbackground=2.73</em>, <em>Tex=5.0</em>, <em>tau=0.1</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.hyperfine.hyperfinemodel.hyperfine_amp" title="Permalink to this definition">¶</a></dt>
<dd><p>wrapper of self.hyperfine with order of arguments changed</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-pyspeckit.spectrum.models.inherited_lorentzian"></span><p>The simplest and most useful model.</p>
<p>Until 12/23/2011, lorentzian fitting used the complicated and somewhat bloated
gaussfitter.py code.  Now, this is a great example of how to make your own
model!</p>
<dl class="function">
<dt id="pyspeckit.spectrum.models.inherited_lorentzian.lorentzian">
<tt class="descclassname">pyspeckit.spectrum.models.inherited_lorentzian.</tt><tt class="descname">lorentzian</tt><big>(</big><em>x</em>, <em>A</em>, <em>dx</em>, <em>w</em>, <em>return_components=False</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.inherited_lorentzian.lorentzian" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a 1-dimensional lorentzian of form
A*2*pi*w/((x-dx)**2 + ((w/2)**2))</p>
<p>[amplitude,center,width]</p>
<p>return_components does nothing but is required by all fitters</p>
</dd></dl>

<dl class="function">
<dt id="pyspeckit.spectrum.models.inherited_lorentzian.lorentzian_fitter">
<tt class="descclassname">pyspeckit.spectrum.models.inherited_lorentzian.</tt><tt class="descname">lorentzian_fitter</tt><big>(</big><em>multisingle='multi'</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.inherited_lorentzian.lorentzian_fitter" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator for lorentzian fitter class</p>
</dd></dl>

<span class="target" id="module-pyspeckit.spectrum.models.modelgrid"></span><p>Fit a line based on parameters output from a grid of models</p>
<dl class="function">
<dt id="pyspeckit.spectrum.models.modelgrid.gaussian_line">
<tt class="descclassname">pyspeckit.spectrum.models.modelgrid.</tt><tt class="descname">gaussian_line</tt><big>(</big><em>xax</em>, <em>maxamp</em>, <em>tau</em>, <em>offset</em>, <em>width</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.modelgrid.gaussian_line" title="Permalink to this definition">¶</a></dt>
<dd><p>A Gaussian line function in which the</p>
</dd></dl>

<dl class="function">
<dt id="pyspeckit.spectrum.models.modelgrid.line_model_2par">
<tt class="descclassname">pyspeckit.spectrum.models.modelgrid.</tt><tt class="descname">line_model_2par</tt><big>(</big><em>xax</em>, <em>center</em>, <em>width</em>, <em>gridval1</em>, <em>gridval2</em>, <em>griddim1</em>, <em>griddim2</em>, <em>maxampgrid</em>, <em>taugrid</em>, <em>linefunction=&lt;function gaussian_line at 0x106d54320&gt;</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.modelgrid.line_model_2par" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the spectral line that matches the given x-axis</p>
<p>xax, center, width must be in the same units!</p>
</dd></dl>

<dl class="function">
<dt id="pyspeckit.spectrum.models.modelgrid.line_params_2D">
<tt class="descclassname">pyspeckit.spectrum.models.modelgrid.</tt><tt class="descname">line_params_2D</tt><big>(</big><em>gridval1</em>, <em>gridval2</em>, <em>griddim1</em>, <em>griddim2</em>, <em>valuegrid</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.modelgrid.line_params_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a 2D grid of modeled line values - the amplitude, e.g. excitation temperature,
and the optical depth, tau - return the model spectrum</p>
<p>griddims contains the names of the axes and their values... it should have the same 
number of entries as gridpars</p>
</dd></dl>

<span class="target" id="module-pyspeckit.spectrum.models.n2hp"></span><div class="section" id="n2h-fitter">
<h2>N2H+ fitter<a class="headerlink" href="#n2h-fitter" title="Permalink to this headline">¶</a></h2>
<p>Reference for line params: 
Daniel, F., Dubernet, M.-L., Meuwly, M., Cernicharo, J., Pagani, L. 2005, MNRAS 363, 1083</p>
<p><a class="reference external" href="http://www.strw.leidenuniv.nl/~moldata/N2H+.html">http://www.strw.leidenuniv.nl/~moldata/N2H+.html</a></p>
<p><a class="reference external" href="http://adsabs.harvard.edu/abs/2005MNRAS.363.1083D">http://adsabs.harvard.edu/abs/2005MNRAS.363.1083D</a></p>
<dl class="docutils">
<dt>Does not yet implement:</dt>
<dd><a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJ...716.1315K">http://adsabs.harvard.edu/abs/2010ApJ...716.1315K</a></dd>
</dl>
<dl class="function">
<dt id="pyspeckit.spectrum.models.n2hp.n2hp_radex">
<tt class="descclassname">pyspeckit.spectrum.models.n2hp.</tt><tt class="descname">n2hp_radex</tt><big>(</big><em>xarr</em>, <em>density=4</em>, <em>column=13</em>, <em>xoff_v=0.0</em>, <em>width=1.0</em>, <em>grid_vwidth=1.0</em>, <em>grid_vwidth_scale=False</em>, <em>texgrid=None</em>, <em>taugrid=None</em>, <em>hdr=None</em>, <em>path_to_texgrid=''</em>, <em>path_to_taugrid=''</em>, <em>temperature_gridnumber=3</em>, <em>debug=False</em>, <em>verbose=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.n2hp.n2hp_radex" title="Permalink to this definition">¶</a></dt>
<dd><p>Use a grid of RADEX-computed models to make a model line spectrum</p>
<p>The RADEX models have to be available somewhere.
OR they can be passed as arrays.  If as arrays, the form should be:
texgrid = ((minfreq1,maxfreq1,texgrid1),(minfreq2,maxfreq2,texgrid2))</p>
<p>xarr must be a SpectroscopicAxis instance
xoff_v, width are both in km/s</p>
<dl class="docutils">
<dt>grid_vwidth is the velocity assumed when computing the grid in km/s</dt>
<dd>this is important because tau = modeltau / width (see, e.g., 
Draine 2011 textbook pgs 219-230)</dd>
</dl>
<p>grid_vwidth_scale is True or False: False for LVG, True for Sphere</p>
</dd></dl>

<dl class="data">
<dt id="pyspeckit.spectrum.models.n2hp.relative_strength_total_degeneracy">
<tt class="descclassname">pyspeckit.spectrum.models.n2hp.</tt><tt class="descname">relative_strength_total_degeneracy</tt><em class="property"> = {'121-011': 9.0, '121-010': 9.0, '121-012': 9.0, '111-010': 9.0, '111-011': 9.0, '111-012': 9.0, '122-012': 9.0, '122-011': 9.0, '112-012': 9.0, '112-011': 9.0, '110-011': 9.0, '101-012': 9.0, '101-011': 9.0, '101-010': 9.0, '123-012': 9.0}</em><a class="headerlink" href="#pyspeckit.spectrum.models.n2hp.relative_strength_total_degeneracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Line strengths of the 15 hyperfine components in J=1-0  transition. The
thickness of the lines indicates their relative weight compared to the others.
Line strengths are normalized in such a way that summing over all initial J = 1
levels gives the degeneracy of the J = 0 levels, i.e.,  for JF1F  012,
three for JF1F  011, and one for JF1F  010. Thus, the sum over all 15
transitions gives the total spin degeneracy</p>
</dd></dl>

</div>
<span class="target" id="module-pyspeckit.spectrum.models.inherited_voigtfitter"></span><dl class="function">
<dt id="pyspeckit.spectrum.models.inherited_voigtfitter.voigt">
<tt class="descclassname">pyspeckit.spectrum.models.inherited_voigtfitter.</tt><tt class="descname">voigt</tt><big>(</big><em>xarr</em>, <em>amp</em>, <em>xcen</em>, <em>Gfwhm</em>, <em>Lfwhm</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.inherited_voigtfitter.voigt" title="Permalink to this definition">¶</a></dt>
<dd><p>voigt profile</p>
<p>V(x,sig,gam) = Re(w(z))/(sig*sqrt(2*pi))
z = (x+i*gam)/(sig*sqrt(2))</p>
<p>Converted from 
<a class="reference external" href="http://mail.scipy.org/pipermail/scipy-user/2011-January/028327.html">http://mail.scipy.org/pipermail/scipy-user/2011-January/028327.html</a></p>
</dd></dl>

<dl class="function">
<dt id="pyspeckit.spectrum.models.inherited_voigtfitter.voigt_fitter">
<tt class="descclassname">pyspeckit.spectrum.models.inherited_voigtfitter.</tt><tt class="descname">voigt_fitter</tt><big>(</big><em>multisingle='multi'</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.inherited_voigtfitter.voigt_fitter" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator for voigt fitter class</p>
</dd></dl>

<span class="target" id="module-pyspeckit.spectrum.models.hydrogen"></span><div class="section" id="hydrogen-models">
<h2>Hydrogen Models<a class="headerlink" href="#hydrogen-models" title="Permalink to this headline">¶</a></h2>
<p>Hydrogen in HII regions is typically assumed to follow Case B recombination
theory.</p>
<p>The values for the Case B recombination coefficients are given by <a class="reference internal" href="#hummerstorey1987">[HummerStorey1987]</a>.  
They are also computed in <a class="reference internal" href="#hummer1994">[Hummer1994]</a> and tabulated at a <a class="reference internal" href="#wiki">[wiki]</a>.  I had to OCR and pull
out by hand some of the coefficients.</p>
<table class="docutils citation" frame="void" id="hummerstorey1987" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[HummerStorey1987]</a></td><td>: <a class="reference external" href="http://adsabs.harvard.edu/cgi-bin/nph-bib_query?bibcode=1987MNRAS.224..801H&amp;db_key=AST">Recombination-line intensities for hydrogenic ions.
I - Case B calculations for H I and He II</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="hummer1994" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[Hummer1994]</a></td><td>: <a class="reference external" href="http://adsabs.harvard.edu/abs/1994MNRAS.268..109H">http://adsabs.harvard.edu/abs/1994MNRAS.268..109H</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="wiki" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[wiki]</a></td><td>:  <a class="reference external" href="http://wiki.hmet.net/index.php/HII_Case_B_Recombination_Coefficients">http://wiki.hmet.net/index.php/HII_Case_B_Recombination_Coefficients</a></td></tr>
</tbody>
</table>
<dl class="function">
<dt id="pyspeckit.spectrum.models.hydrogen.add_to_registry">
<tt class="descclassname">pyspeckit.spectrum.models.hydrogen.</tt><tt class="descname">add_to_registry</tt><big>(</big><em>sp</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.hydrogen.add_to_registry" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the Hydrogen model to the Spectrum&#8217;s fitter registry</p>
</dd></dl>

<dl class="function">
<dt id="pyspeckit.spectrum.models.hydrogen.find_lines">
<tt class="descclassname">pyspeckit.spectrum.models.hydrogen.</tt><tt class="descname">find_lines</tt><big>(</big><em>xarr</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.hydrogen.find_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a <tt class="xref py py-class docutils literal"><span class="pre">pyspeckit.units.SpectrosopicAxis</span></tt> instance, finds all the
lines that are in bounds.  Returns a list of line names.</p>
</dd></dl>

<dl class="function">
<dt id="pyspeckit.spectrum.models.hydrogen.hydrogen_fitter">
<tt class="descclassname">pyspeckit.spectrum.models.hydrogen.</tt><tt class="descname">hydrogen_fitter</tt><big>(</big><em>sp</em>, <em>temperature=10000</em>, <em>tiedwidth=False</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.hydrogen.hydrogen_fitter" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a set of parameters identifying the hydrogen lines in your
spectrum.  These come in groups of 3 assuming you&#8217;re fitting a gaussian to
each.  You can tie the widths or choose not to.</p>
<dl class="docutils">
<dt><em>temperature</em> [ 5000, 10000, 20000 ]</dt>
<dd>The case B coefficients are computed for 3 temperatures</dd>
<dt><em>tiedwidth</em> [ bool ] </dt>
<dd>Should the widths be tied?</dd>
</dl>
<p>Returns a list of <cite>tied</cite> and <cite>guesses</cite> in the xarr&#8217;s units</p>
</dd></dl>

<dl class="function">
<dt id="pyspeckit.spectrum.models.hydrogen.hydrogen_model">
<tt class="descclassname">pyspeckit.spectrum.models.hydrogen.</tt><tt class="descname">hydrogen_model</tt><big>(</big><em>xarr</em>, <em>amplitude=1.0</em>, <em>width=0.0</em>, <em>velocity=0.0</em>, <em>a_k=0.0</em>, <em>temperature=10000</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.hydrogen.hydrogen_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a set of parameters identifying the hydrogen lines in your
spectrum.  These come in groups of 3 assuming you&#8217;re fitting a gaussian to
each.  You can tie the widths or choose not to.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>sp</strong> : pyspeckit.Spectrum</p>
<blockquote>
<div><p>The spectrum to fit</p>
</div></blockquote>
<p><strong>temperature</strong> : [ 5000, 10000, 20000 ]</p>
<blockquote>
<div><p>The case B coefficients are computed for 3 temperatures</p>
</div></blockquote>
<p><strong>a_k</strong> : float</p>
<blockquote>
<div><p>The K-band extinction normalized to 2.2 microns.  Simple
exponential.</p>
</div></blockquote>
<p><strong>width</strong> : float</p>
<blockquote>
<div><p>Line width in km/s</p>
</div></blockquote>
<p><strong>velocity</strong> : float</p>
<blockquote>
<div><p>Line center in km/s</p>
</div></blockquote>
<p><strong>amplitude</strong> : float</p>
<blockquote>
<div><p>arbitrary amplitude of the first line (all other lines
will be scaled to this value)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first last"><strong>np.ndarray with same shape as sp.xarr</strong> :</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyspeckit.spectrum.models.hydrogen.rrl">
<tt class="descclassname">pyspeckit.spectrum.models.hydrogen.</tt><tt class="descname">rrl</tt><big>(</big><em>n</em>, <em>dn=1</em>, <em>amu=1.007825</em><big>)</big><a class="headerlink" href="#pyspeckit.spectrum.models.hydrogen.rrl" title="Permalink to this definition">¶</a></dt>
<dd><p>compute Radio Recomb Line freqs in GHz
from Brown, Lockman &amp; Knapp ARAA 1978 16 445</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation and Requirements</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Models &amp; Fitting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-api">Module API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#n2h-fitter">N2H+ fitter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hydrogen-models">Hydrogen Models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="features.html">Class Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="readers.html">File Readers</a></li>
<li class="toctree-l1"><a class="reference internal" href="wrappers.html">High-Level Wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="interactive.html">Interactive Use</a></li>
</ul>

          <h3 style="margin-top: 1.5em;">Search</h3>
          <form class="search" action="search.html" method="get">
            <input type="text" name="q" />
            <input type="submit" value="Go" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
          <p class="searchtip" style="font-size: 90%">
            Enter search terms or a module, class or function name.
          </p>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer">
    <table width=800><tr>
            <td align=left>
      &copy; Copyright 2011, Adam Ginsburg and Jordan Mirocha.
    </td>
    <td align=right><a href="mailto:pyspeckit@gmail.com">Contact us</a></td>
    </tr>
    <tr><td>
      Last updated on Jun 25, 2012.
    </td><td align=right>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
    </td>
    <tr>
            <td align=left><a href="pyspeckit.pdf">PDF version of this document</a></td>
    </tr></table>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-6253200-7']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
        
    </div>
  </body>
</html>